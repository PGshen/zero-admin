webpackJsonp([41],{QwCU:function(e,t,i){var l=i("t4Uj");"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);i("rjj0")("27745f32",l,!0)},alMD:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i("Dd8w"),r=i.n(l),n=i("NYxO"),a={data:function(){return{orgProps:{children:"children",label:"name",value:"id"},listQuery:{page:1,size:20,order:"id",cond:{}},btn:this.$route.params.btn,total:null,treeItem:"",displayList:null,listLoading:!1,sortOptions:[{label:"按ID升序列",key:"+id"},{label:"按ID降序",key:"id desc"}],tableKey:0,dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑组织",create:"创建组织"},org:{id:"",parentId:"",name:"",email:"",remark:"",postCode:"",tel:"",type:"",description:""},orgType:[{value:"公司",label:"公司"},{value:"部门",label:"部门"}]}},created:function(){this.getOrgTree()},computed:r()({},Object(n.c)(["orgTree","orgList"])),methods:r()({},Object(n.b)({GetOrgTree:"GetOrgTree",DeleteOrg:"DeleteOrg",AddOrg:"AddOrg",UpdateOrg:"UpdateOrg"}),{getOrgTree:function(){var e=this;this.GetOrgTree().then(function(t){t?e.displayList=e.orgTree:e.$notify({title:"失败",message:"获取菜单结构失败",type:"failure",duration:2e3})})},deleteNullChildren:function(e){var t=void 0;for(t in e)0===e[t].children.length?delete e[t].children:this.deleteNullChildren(e[t].children)},handleCascaderChange:function(e){this.org.parentId=e[e.length-1]},handleFilter:function(){this.dialogStatus=""},handleCreate:function(){this.org.id="",this.org.parentId="",this.org.name="",this.org.email="",this.org.remark="",this.org.postCode="",this.org.tel="",this.org.type="",this.org.description="",this.dialogStatus="create",this.dialogFormVisible=!0},handleUpdate:function(e){this.org.id=e.id,this.org.parentId=e.parentId,this.org.name=e.name,this.org.email=e.email,this.org.remark=e.remark,this.org.postCode=e.postCode,this.org.tel=e.tel,this.org.type=e.type,this.org.description=e.description,this.dialogStatus="update",this.dialogFormVisible=!0},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.DeleteOrg(e.id).then(function(e){e&&(t.$message({type:"success",message:"删除成功!"}),t.getOrgTree())})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleDownload:function(){this.dialogStatus=""},handleSizeChange:function(e){this.listQuery.size=e},handlePageChange:function(e){this.listQuery.page=e},create:function(){var e=this;this.AddOrg(this.org).then(function(t){t&&(e.dialogFormVisible=!1,e.getOrgTree())})},update:function(){var e=this;this.UpdateOrg(this.org).then(function(t){t&&(e.dialogFormVisible=!1,e.getOrgTree())})},handleNodeClick:function(e){this.treeItem=e.name},getOrgItem:function(e,t){var i=this;if(void 0===t||null===t)return null;var l=null;return t.forEach(function(t,r){if(e===t.name)l=t.children;else{var n=null;null!==t.children&&null!==(n=i.getOrgItem(e,t.children))&&(l=n)}}),l}}),watch:{treeItem:function(e){null!==e&&(this.displayList=null,this.displayList=this.getOrgItem(e,this.orgList))},orgTree:function(e){null!==e&&this.deleteNullChildren(this.orgTree)}}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container org-container"},[i("div",{staticClass:"left-bar"},[i("el-card",{staticStyle:{"min-height":"100%"}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("span",{staticStyle:{"line-height":"10px"}},[e._v("组织结构")])]),e._v(" "),i("el-tree",{attrs:{data:e.orgTree,props:e.orgProps,"highlight-current":!0,accordion:""},on:{"node-click":e.handleNodeClick}})],1)],1),e._v(" "),i("div",{staticClass:"right-content"},[i("el-card",{staticStyle:{"min-height":"100%"}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("span",{staticStyle:{"line-height":"10px"}},[e._v("组织列表")])]),e._v(" "),i("div",{staticClass:"body"},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"组织名称"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.handleFilter(t)}},model:{value:e.listQuery.cond.name,callback:function(t){e.$set(e.listQuery.cond,"name",t)},expression:"listQuery.cond.name"}}),e._v(" "),i("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{placeholder:"排序"},on:{change:e.handleFilter},model:{value:e.listQuery.order,callback:function(t){e.$set(e.listQuery,"order",t)},expression:"listQuery.order"}},e._l(e.sortOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),e._v(" "),void 0!==e.btn&&-1!==e.btn.indexOf("base:org:list")?i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:e.handleFilter}},[e._v("搜索")]):e._e(),e._v(" "),void 0!==e.btn&&-1!==e.btn.indexOf("base:org:add")?i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"edit"},on:{click:e.handleCreate}},[e._v("\n            添加\n          ")]):e._e(),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"document"},on:{click:e.handleDownload}},[e._v("导出")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.displayList,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"序号",width:"130",type:"index"}}),e._v(" "),i("el-table-column",{attrs:{"min-width":"130",label:"组织名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"link-type",on:{click:function(i){e.handleUpdate(t.row)}}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{"min-width":"130",label:"组织类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.type))])]}}])}),e._v(" "),i("el-table-column",{attrs:{"min-width":"130",label:"组织描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.description))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[void 0!==e.btn&&-1!==e.btn.indexOf("base:org:update")?i("el-button",{attrs:{size:"small",type:"success"},on:{click:function(i){e.handleUpdate(t.row)}}},[e._v("编辑\n              ")]):e._e(),e._v(" "),void 0!==e.btn&&-1!==e.btn.indexOf("base:org:delete")?i("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(i){e.handleDelete(t.row)}}},[e._v("删除\n              ")]):e._e()]}}])})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange,"update:currentPage":function(t){e.$set(e.listQuery,"page",t)}}})],1),e._v(" "),i("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],"close-on-click-modal":!1,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{staticClass:"small-space org-form",attrs:{inline:!0,model:e.org,"label-position":"left","label-width":"70px"}},[i("el-form-item",{staticClass:"org-form-item",attrs:{label:"组织路径"}},[i("el-cascader",{attrs:{props:e.orgProps,options:e.orgTree,"change-on-select":""},on:{change:e.handleCascaderChange}})],1),e._v(" "),i("el-form-item",{staticClass:"org-form-item",attrs:{label:"组织类型"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.org.type,callback:function(t){e.$set(e.org,"type",t)},expression:"org.type"}},e._l(e.orgType,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),i("el-form-item",{staticClass:"org-form-item",attrs:{label:"组织名称"}},[i("el-input",{staticClass:"filter-item",attrs:{placeholder:"请输入组织名称"},model:{value:e.org.name,callback:function(t){e.$set(e.org,"name",t)},expression:"org.name"}})],1),e._v(" "),i("el-form-item",{staticClass:"org-form-item",attrs:{label:"组织邮箱"}},[i("el-input",{staticClass:"filter-item",attrs:{placeholder:"请输入组织邮箱"},model:{value:e.org.email,callback:function(t){e.$set(e.org,"email",t)},expression:"org.email"}})],1),e._v(" "),i("el-form-item",{staticClass:"org-form-item",attrs:{label:"备注"}},[i("el-input",{staticClass:"filter-item",attrs:{placeholder:"请输入备注"},model:{value:e.org.remark,callback:function(t){e.$set(e.org,"remark",t)},expression:"org.remark"}})],1),e._v(" "),i("el-form-item",{staticClass:"org-form-item",attrs:{label:"组织编码"}},[i("el-input",{staticClass:"filter-item",attrs:{placeholder:"请输入组织编码"},model:{value:e.org.postCode,callback:function(t){e.$set(e.org,"postCode",t)},expression:"org.postCode"}})],1),e._v(" "),i("el-form-item",{staticClass:"org-form-item",attrs:{label:"组织电话"}},[i("el-input",{staticClass:"filter-item",attrs:{placeholder:"请输入组织电话"},model:{value:e.org.tel,callback:function(t){e.$set(e.org,"tel",t)},expression:"org.tel"}})],1),e._v(" "),i("el-form-item",{staticClass:"org-form-item",attrs:{label:"组织描述"}},[i("el-input",{staticClass:"filter-item",attrs:{placeholder:"请输入组织描述"},model:{value:e.org.description,callback:function(t){e.$set(e.org,"description",t)},expression:"org.description"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),"create"==e.dialogStatus?i("el-button",{attrs:{type:"primary"},on:{click:e.create}},[e._v("确 定")]):i("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1)],1)],1)])],1)])},staticRenderFns:[]};var s=i("VU/8")(a,o,!1,function(e){i("QwCU")},null,null);t.default=s.exports},t4Uj:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,'\n@charset "UTF-8";\n.org-container {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n  height: 100%;\n  width: 100%;\n}\n.org-container .left-bar {\n  height: 100%;\n  -webkit-box-flex: 2;\n      -ms-flex: 2;\n          flex: 2;\n}\n.org-container .left-bar .el-tree--highlight-current .el-tree-node.is-current > .el-tree-node__content {\n  background-color: lightblue;\n}\n.org-container .left-bar .el-tree {\n  border: 0;\n}\n.org-container .right-content {\n  height: 100%;\n  -webkit-box-flex: 8;\n      -ms-flex: 8;\n          flex: 8;\n  margin-left: 20px;\n}\n.org-container .right-content .org-form {\n  width: 92%;\n  margin-left: 8%;\n}\n.org-container .right-content .org-form .org-form-item {\n  width: 46%;\n  margin-right: 20px;\n}\n/* 覆盖掉原先el-form-item__content样式，使得内容宽度占满父元素 */\n.org-container .right-content .org-form .org-form-item .el-form-item__content {\n  display: inline-block;\n  vertical-align: top;\n  width: 73%;\n}\n',""])}});